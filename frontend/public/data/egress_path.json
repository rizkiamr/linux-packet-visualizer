{
  "version": "1.1.0",
  "kernelVersion": "5.10.8",
  "generatedAt": "2026-01-03T18:17:38Z",
  "paths": [
    {
      "path": {
        "id": "tcp_ipv4_egress",
        "name": "TCP/IPv4 Egress Path",
        "description": "The path of a TCP packet from user space through the kernel to the network interface (Linux 5.10.8)",
        "direction": "egress",
        "protocol": "TCP",
        "functions": [
          {
            "id": "tcp_sendmsg",
            "name": "tcp_sendmsg",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp.c",
            "lineNumber": 1434,
            "description": "Entry point for TCP send operations. Acquires socket lock and delegates to tcp_sendmsg_locked.",
            "isEntryPoint": true
          },
          {
            "id": "tcp_sendmsg_locked",
            "name": "tcp_sendmsg_locked",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp.c",
            "lineNumber": 1172,
            "description": "Core TCP send logic. Allocates sk_buff and copies user data into kernel space.",
            "skbMutation": {
              "operation": "alloc",
              "size": 2048,
              "description": "Allocate sk_buff with headroom for all protocol headers"
            }
          },
          {
            "id": "tcp_push",
            "name": "tcp_push",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp.c",
            "lineNumber": 689,
            "description": "Pushes pending data. Sets PSH flag if socket is being closed or buffer is full."
          },
          {
            "id": "__tcp_push_pending_frames",
            "name": "__tcp_push_pending_frames",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_output.c",
            "lineNumber": 2556,
            "description": "Checks if there is data to send and initiates transmission."
          },
          {
            "id": "tcp_write_xmit",
            "name": "tcp_write_xmit",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_output.c",
            "lineNumber": 2387,
            "description": "Main TCP transmission loop. Handles congestion control, pacing, and TSO segmentation."
          },
          {
            "id": "__tcp_transmit_skb",
            "name": "__tcp_transmit_skb",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_output.c",
            "lineNumber": 1164,
            "description": "Builds the TCP header. Calculates checksum and sets sequence numbers.",
            "skbMutation": {
              "operation": "push",
              "headerType": "tcp",
              "size": 20,
              "description": "Push tcp header"
            }
          },
          {
            "id": "ip_queue_xmit",
            "name": "ip_queue_xmit",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_output.c",
            "lineNumber": 470,
            "description": "Main IPv4 transmission entry point from transport layer. Handles routing lookup and IP header construction.",
            "skbMutation": {
              "operation": "push",
              "headerType": "ip",
              "size": 20,
              "description": "Push ip header"
            }
          },
          {
            "id": "ip_local_out",
            "name": "ip_local_out",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_output.c",
            "lineNumber": 115,
            "description": "Wrapper for locally generated packets. Calls __ip_local_out."
          },
          {
            "id": "__ip_local_out",
            "name": "__ip_local_out",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_output.c",
            "lineNumber": 96,
            "description": "Sets IP packet length and checksum. Invokes LOCAL_OUT netfilter hook.",
            "netfilterHook": {
              "hook": "OUTPUT",
              "tables": [
                "raw",
                "mangle",
                "nat",
                "filter"
              ],
              "description": "Locally generated packets. Firewall rules (iptables -A OUTPUT) are evaluated here.",
              "priority": -100
            }
          },
          {
            "id": "ip_output",
            "name": "ip_output",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_output.c",
            "lineNumber": 413,
            "description": "Called after LOCAL_OUT hook. Invokes POST_ROUTING netfilter hook.",
            "netfilterHook": {
              "hook": "POSTROUTING",
              "tables": [
                "mangle",
                "nat"
              ],
              "description": "Final hook before packet leaves. SNAT/MASQUERADE applied here.",
              "priority": 100
            }
          },
          {
            "id": "ip_finish_output",
            "name": "ip_finish_output",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_output.c",
            "lineNumber": 311,
            "description": "BPF cgroup egress hook point. Handles GSO segmentation if needed.",
            "bpfHook": {
              "type": "CGROUP_SKB",
              "attachPoint": "Cgroup egress path",
              "description": "Cgroup socket buffer hook. Used for container networking policies and egress filtering.",
              "actions": [
                "ALLOW",
                "DENY"
              ]
            }
          },
          {
            "id": "__ip_finish_output",
            "name": "__ip_finish_output",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_output.c",
            "lineNumber": 287,
            "description": "Checks MTU and fragments packet if necessary."
          },
          {
            "id": "ip_finish_output2",
            "name": "ip_finish_output2",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_output.c",
            "lineNumber": 187,
            "description": "Resolves next-hop neighbor (ARP lookup) and prepares for L2 transmission."
          },
          {
            "id": "neigh_output",
            "name": "neigh_output",
            "layer": "Network Layer",
            "sourceFile": "include/net/neighbour.h",
            "lineNumber": 510,
            "description": "Neighbour subsystem output. Uses cached hardware header if available."
          },
          {
            "id": "neigh_hh_output",
            "name": "neigh_hh_output",
            "layer": "Data Link Layer",
            "sourceFile": "include/net/neighbour.h",
            "lineNumber": 490,
            "description": "Fast path using cached hardware header. Pushes Ethernet header.",
            "skbMutation": {
              "operation": "push",
              "headerType": "ethernet",
              "size": 14,
              "description": "Push ethernet header"
            }
          },
          {
            "id": "dev_queue_xmit",
            "name": "dev_queue_xmit",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 4044,
            "description": "Main device transmission entry point. Handles per-CPU processing."
          },
          {
            "id": "__dev_queue_xmit",
            "name": "__dev_queue_xmit",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 3954,
            "description": "Core queuing logic. TC egress BPF programs run here before qdisc.",
            "bpfHook": {
              "type": "TC_EGRESS",
              "attachPoint": "Traffic Control egress qdisc",
              "description": "Traffic Control classifier on egress. Can shape, filter, or redirect outgoing packets.",
              "actions": [
                "TC_ACT_OK",
                "TC_ACT_SHOT",
                "TC_ACT_REDIRECT",
                "TC_ACT_PIPE"
              ]
            }
          },
          {
            "id": "__dev_xmit_skb",
            "name": "__dev_xmit_skb",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 3683,
            "description": "Submits packet to qdisc. May queue or directly transmit based on qdisc state."
          },
          {
            "id": "sch_direct_xmit",
            "name": "sch_direct_xmit",
            "layer": "Data Link Layer",
            "sourceFile": "net/sched/sch_generic.c",
            "lineNumber": 310,
            "description": "Bypasses qdisc queue for direct transmission when possible."
          },
          {
            "id": "dev_hard_start_xmit",
            "name": "dev_hard_start_xmit",
            "layer": "Device Driver",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 3506,
            "description": "Final generic layer before driver. Handles XDP and calls driver's ndo_start_xmit."
          },
          {
            "id": "ndo_start_xmit",
            "name": "ndo_start_xmit",
            "layer": "Device Driver",
            "sourceFile": "include/linux/netdevice.h",
            "lineNumber": 1298,
            "description": "Driver-specific transmit function. Pointer to actual driver implementation (e.g., e1000, virtio-net).",
            "isExitPoint": true
          }
        ],
        "edges": [
          {
            "from": "tcp_sendmsg",
            "to": "tcp_sendmsg_locked",
            "order": 1
          },
          {
            "from": "tcp_sendmsg_locked",
            "to": "tcp_push",
            "order": 1
          },
          {
            "from": "tcp_push",
            "to": "__tcp_push_pending_frames",
            "order": 1
          },
          {
            "from": "__tcp_push_pending_frames",
            "to": "tcp_write_xmit",
            "order": 1
          },
          {
            "from": "tcp_write_xmit",
            "to": "__tcp_transmit_skb",
            "order": 1
          },
          {
            "from": "__tcp_transmit_skb",
            "to": "ip_queue_xmit",
            "order": 1
          },
          {
            "from": "ip_queue_xmit",
            "to": "ip_local_out",
            "order": 1
          },
          {
            "from": "ip_local_out",
            "to": "__ip_local_out",
            "order": 1
          },
          {
            "from": "__ip_local_out",
            "to": "ip_output",
            "order": 1
          },
          {
            "from": "ip_output",
            "to": "ip_finish_output",
            "order": 1
          },
          {
            "from": "ip_finish_output",
            "to": "__ip_finish_output",
            "order": 1
          },
          {
            "from": "__ip_finish_output",
            "to": "ip_finish_output2",
            "order": 1
          },
          {
            "from": "ip_finish_output2",
            "to": "neigh_output",
            "order": 1
          },
          {
            "from": "neigh_output",
            "to": "neigh_hh_output",
            "condition": "Hardware header cached",
            "order": 1
          },
          {
            "from": "neigh_hh_output",
            "to": "dev_queue_xmit",
            "order": 1
          },
          {
            "from": "dev_queue_xmit",
            "to": "__dev_queue_xmit",
            "order": 1
          },
          {
            "from": "__dev_queue_xmit",
            "to": "__dev_xmit_skb",
            "order": 1
          },
          {
            "from": "__dev_xmit_skb",
            "to": "sch_direct_xmit",
            "condition": "Direct transmit allowed",
            "order": 1
          },
          {
            "from": "sch_direct_xmit",
            "to": "dev_hard_start_xmit",
            "order": 1
          },
          {
            "from": "dev_hard_start_xmit",
            "to": "ndo_start_xmit",
            "order": 1
          }
        ],
        "entryPoint": "tcp_sendmsg",
        "exitPoints": [
          "ndo_start_xmit"
        ]
      },
      "simulation": [
        {
          "stepNumber": 1,
          "function": {
            "id": "tcp_sendmsg",
            "name": "tcp_sendmsg",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp.c",
            "lineNumber": 1434,
            "description": "Entry point for TCP send operations. Acquires socket lock and delegates to tcp_sendmsg_locked.",
            "isEntryPoint": true
          },
          "skbuffState": {
            "head": 0,
            "data": 1048,
            "tail": 2048,
            "end": 2048,
            "layers": []
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 2,
          "function": {
            "id": "tcp_sendmsg_locked",
            "name": "tcp_sendmsg_locked",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp.c",
            "lineNumber": 1172,
            "description": "Core TCP send logic. Allocates sk_buff and copies user data into kernel space.",
            "skbMutation": {
              "operation": "alloc",
              "size": 2048,
              "description": "Allocate sk_buff with headroom for all protocol headers"
            }
          },
          "skbuffState": {
            "head": 0,
            "data": 1048,
            "tail": 2048,
            "end": 2048,
            "layers": []
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 3,
          "function": {
            "id": "tcp_push",
            "name": "tcp_push",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp.c",
            "lineNumber": 689,
            "description": "Pushes pending data. Sets PSH flag if socket is being closed or buffer is full."
          },
          "skbuffState": {
            "head": 0,
            "data": 1048,
            "tail": 2048,
            "end": 2048,
            "layers": []
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 4,
          "function": {
            "id": "__tcp_push_pending_frames",
            "name": "__tcp_push_pending_frames",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_output.c",
            "lineNumber": 2556,
            "description": "Checks if there is data to send and initiates transmission."
          },
          "skbuffState": {
            "head": 0,
            "data": 1048,
            "tail": 2048,
            "end": 2048,
            "layers": []
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 5,
          "function": {
            "id": "tcp_write_xmit",
            "name": "tcp_write_xmit",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_output.c",
            "lineNumber": 2387,
            "description": "Main TCP transmission loop. Handles congestion control, pacing, and TSO segmentation."
          },
          "skbuffState": {
            "head": 0,
            "data": 1048,
            "tail": 2048,
            "end": 2048,
            "layers": []
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 6,
          "function": {
            "id": "__tcp_transmit_skb",
            "name": "__tcp_transmit_skb",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_output.c",
            "lineNumber": 1164,
            "description": "Builds the TCP header. Calculates checksum and sets sequence numbers.",
            "skbMutation": {
              "operation": "push",
              "headerType": "tcp",
              "size": 20,
              "description": "Push tcp header"
            }
          },
          "skbuffState": {
            "head": 0,
            "data": 1028,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "tcp",
                "offset": 0,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 7,
          "function": {
            "id": "ip_queue_xmit",
            "name": "ip_queue_xmit",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_output.c",
            "lineNumber": 470,
            "description": "Main IPv4 transmission entry point from transport layer. Handles routing lookup and IP header construction.",
            "skbMutation": {
              "operation": "push",
              "headerType": "ip",
              "size": 20,
              "description": "Push ip header"
            }
          },
          "skbuffState": {
            "head": 0,
            "data": 1008,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "ip",
                "offset": 0,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 20,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 8,
          "function": {
            "id": "ip_local_out",
            "name": "ip_local_out",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_output.c",
            "lineNumber": 115,
            "description": "Wrapper for locally generated packets. Calls __ip_local_out."
          },
          "skbuffState": {
            "head": 0,
            "data": 1008,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "ip",
                "offset": 0,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 20,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 9,
          "function": {
            "id": "__ip_local_out",
            "name": "__ip_local_out",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_output.c",
            "lineNumber": 96,
            "description": "Sets IP packet length and checksum. Invokes LOCAL_OUT netfilter hook.",
            "netfilterHook": {
              "hook": "OUTPUT",
              "tables": [
                "raw",
                "mangle",
                "nat",
                "filter"
              ],
              "description": "Locally generated packets. Firewall rules (iptables -A OUTPUT) are evaluated here.",
              "priority": -100
            }
          },
          "skbuffState": {
            "head": 0,
            "data": 1008,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "ip",
                "offset": 0,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 20,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 10,
          "function": {
            "id": "ip_output",
            "name": "ip_output",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_output.c",
            "lineNumber": 413,
            "description": "Called after LOCAL_OUT hook. Invokes POST_ROUTING netfilter hook.",
            "netfilterHook": {
              "hook": "POSTROUTING",
              "tables": [
                "mangle",
                "nat"
              ],
              "description": "Final hook before packet leaves. SNAT/MASQUERADE applied here.",
              "priority": 100
            }
          },
          "skbuffState": {
            "head": 0,
            "data": 1008,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "ip",
                "offset": 0,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 20,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 11,
          "function": {
            "id": "ip_finish_output",
            "name": "ip_finish_output",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_output.c",
            "lineNumber": 311,
            "description": "BPF cgroup egress hook point. Handles GSO segmentation if needed.",
            "bpfHook": {
              "type": "CGROUP_SKB",
              "attachPoint": "Cgroup egress path",
              "description": "Cgroup socket buffer hook. Used for container networking policies and egress filtering.",
              "actions": [
                "ALLOW",
                "DENY"
              ]
            }
          },
          "skbuffState": {
            "head": 0,
            "data": 1008,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "ip",
                "offset": 0,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 20,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 12,
          "function": {
            "id": "__ip_finish_output",
            "name": "__ip_finish_output",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_output.c",
            "lineNumber": 287,
            "description": "Checks MTU and fragments packet if necessary."
          },
          "skbuffState": {
            "head": 0,
            "data": 1008,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "ip",
                "offset": 0,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 20,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 13,
          "function": {
            "id": "ip_finish_output2",
            "name": "ip_finish_output2",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_output.c",
            "lineNumber": 187,
            "description": "Resolves next-hop neighbor (ARP lookup) and prepares for L2 transmission."
          },
          "skbuffState": {
            "head": 0,
            "data": 1008,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "ip",
                "offset": 0,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 20,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 14,
          "function": {
            "id": "neigh_output",
            "name": "neigh_output",
            "layer": "Network Layer",
            "sourceFile": "include/net/neighbour.h",
            "lineNumber": 510,
            "description": "Neighbour subsystem output. Uses cached hardware header if available."
          },
          "skbuffState": {
            "head": 0,
            "data": 1008,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "ip",
                "offset": 0,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 20,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 15,
          "function": {
            "id": "neigh_hh_output",
            "name": "neigh_hh_output",
            "layer": "Data Link Layer",
            "sourceFile": "include/net/neighbour.h",
            "lineNumber": 490,
            "description": "Fast path using cached hardware header. Pushes Ethernet header.",
            "skbMutation": {
              "operation": "push",
              "headerType": "ethernet",
              "size": 14,
              "description": "Push ethernet header"
            }
          },
          "skbuffState": {
            "head": 0,
            "data": 994,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "ethernet",
                "offset": 0,
                "size": 14
              },
              {
                "protocol": "ip",
                "offset": 14,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 34,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 16,
          "function": {
            "id": "dev_queue_xmit",
            "name": "dev_queue_xmit",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 4044,
            "description": "Main device transmission entry point. Handles per-CPU processing."
          },
          "skbuffState": {
            "head": 0,
            "data": 994,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "ethernet",
                "offset": 0,
                "size": 14
              },
              {
                "protocol": "ip",
                "offset": 14,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 34,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 17,
          "function": {
            "id": "__dev_queue_xmit",
            "name": "__dev_queue_xmit",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 3954,
            "description": "Core queuing logic. TC egress BPF programs run here before qdisc.",
            "bpfHook": {
              "type": "TC_EGRESS",
              "attachPoint": "Traffic Control egress qdisc",
              "description": "Traffic Control classifier on egress. Can shape, filter, or redirect outgoing packets.",
              "actions": [
                "TC_ACT_OK",
                "TC_ACT_SHOT",
                "TC_ACT_REDIRECT",
                "TC_ACT_PIPE"
              ]
            }
          },
          "skbuffState": {
            "head": 0,
            "data": 994,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "ethernet",
                "offset": 0,
                "size": 14
              },
              {
                "protocol": "ip",
                "offset": 14,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 34,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 18,
          "function": {
            "id": "__dev_xmit_skb",
            "name": "__dev_xmit_skb",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 3683,
            "description": "Submits packet to qdisc. May queue or directly transmit based on qdisc state."
          },
          "skbuffState": {
            "head": 0,
            "data": 994,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "ethernet",
                "offset": 0,
                "size": 14
              },
              {
                "protocol": "ip",
                "offset": 14,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 34,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 19,
          "function": {
            "id": "sch_direct_xmit",
            "name": "sch_direct_xmit",
            "layer": "Data Link Layer",
            "sourceFile": "net/sched/sch_generic.c",
            "lineNumber": 310,
            "description": "Bypasses qdisc queue for direct transmission when possible."
          },
          "skbuffState": {
            "head": 0,
            "data": 994,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "ethernet",
                "offset": 0,
                "size": 14
              },
              {
                "protocol": "ip",
                "offset": 14,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 34,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 20,
          "function": {
            "id": "dev_hard_start_xmit",
            "name": "dev_hard_start_xmit",
            "layer": "Device Driver",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 3506,
            "description": "Final generic layer before driver. Handles XDP and calls driver's ndo_start_xmit."
          },
          "skbuffState": {
            "head": 0,
            "data": 994,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "ethernet",
                "offset": 0,
                "size": 14
              },
              {
                "protocol": "ip",
                "offset": 14,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 34,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 21,
          "function": {
            "id": "ndo_start_xmit",
            "name": "ndo_start_xmit",
            "layer": "Device Driver",
            "sourceFile": "include/linux/netdevice.h",
            "lineNumber": 1298,
            "description": "Driver-specific transmit function. Pointer to actual driver implementation (e.g., e1000, virtio-net).",
            "isExitPoint": true
          },
          "skbuffState": {
            "head": 0,
            "data": 994,
            "tail": 2048,
            "end": 2048,
            "layers": [
              {
                "protocol": "ethernet",
                "offset": 0,
                "size": 14
              },
              {
                "protocol": "ip",
                "offset": 14,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 34,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        }
      ]
    },
    {
      "path": {
        "id": "tcp_ipv4_ingress",
        "name": "TCP/IPv4 Ingress Path",
        "description": "The path of a TCP packet from the network interface through the kernel to user space (Linux 5.10.8)",
        "direction": "ingress",
        "protocol": "TCP",
        "functions": [
          {
            "id": "napi_poll",
            "name": "napi_poll",
            "layer": "Device Driver",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 6513,
            "description": "NAPI polling entry point. Called by softirq to process received packets from the driver's ring buffer.",
            "isEntryPoint": true
          },
          {
            "id": "napi_gro_receive",
            "name": "napi_gro_receive",
            "layer": "Device Driver",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 5895,
            "description": "Generic Receive Offload handler. XDP programs run here before sk_buff allocation.",
            "bpfHook": {
              "type": "XDP",
              "attachPoint": "NIC driver RX path",
              "description": "eXpress Data Path. Runs before sk_buff allocation for maximum performance. Can drop, pass, or redirect packets.",
              "actions": [
                "XDP_PASS",
                "XDP_DROP",
                "XDP_TX",
                "XDP_REDIRECT",
                "XDP_ABORTED"
              ]
            }
          },
          {
            "id": "napi_skb_finish",
            "name": "napi_skb_finish",
            "layer": "Device Driver",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 5767,
            "description": "Finishes GRO processing and passes the sk_buff up the stack."
          },
          {
            "id": "netif_receive_skb",
            "name": "netif_receive_skb",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 5362,
            "description": "Main entry point for receiving packets from the driver. Timestamps and prepares the packet."
          },
          {
            "id": "netif_receive_skb_internal",
            "name": "netif_receive_skb_internal",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 5320,
            "description": "Internal receive handler. Handles RPS (Receive Packet Steering) if enabled."
          },
          {
            "id": "__netif_receive_skb",
            "name": "__netif_receive_skb",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 5247,
            "description": "Core receive function. TC ingress BPF programs and generic XDP run here.",
            "bpfHook": {
              "type": "TC_INGRESS",
              "attachPoint": "Traffic Control ingress qdisc",
              "description": "Traffic Control classifier. Can filter, modify, or redirect packets on ingress.",
              "actions": [
                "TC_ACT_OK",
                "TC_ACT_SHOT",
                "TC_ACT_REDIRECT",
                "TC_ACT_PIPE"
              ]
            }
          },
          {
            "id": "__netif_receive_skb_one_core",
            "name": "__netif_receive_skb_one_core",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 5198,
            "description": "Single-core receive path. Processes packet on current CPU."
          },
          {
            "id": "__netif_receive_skb_core",
            "name": "__netif_receive_skb_core",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 5067,
            "description": "Core packet classification. Strips Ethernet header and determines protocol handler.",
            "skbMutation": {
              "operation": "pull",
              "headerType": "ethernet",
              "size": 14,
              "description": "Pull ethernet header"
            }
          },
          {
            "id": "deliver_skb",
            "name": "deliver_skb",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 1988,
            "description": "Delivers packet to the registered protocol handler (e.g., ip_rcv for IPv4)."
          },
          {
            "id": "ip_rcv",
            "name": "ip_rcv",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_input.c",
            "lineNumber": 523,
            "description": "IPv4 receive entry point. Validates IP header checksum and invokes PREROUTING netfilter hook.",
            "netfilterHook": {
              "hook": "PREROUTING",
              "tables": [
                "raw",
                "mangle",
                "nat"
              ],
              "description": "First hook for incoming packets. DNAT applied here before routing.",
              "priority": -300
            }
          },
          {
            "id": "ip_rcv_finish",
            "name": "ip_rcv_finish",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_input.c",
            "lineNumber": 401,
            "description": "Finishes IP header processing. Performs routing lookup and strips IP header.",
            "skbMutation": {
              "operation": "pull",
              "headerType": "ip",
              "size": 20,
              "description": "Pull ip header"
            }
          },
          {
            "id": "ip_local_deliver",
            "name": "ip_local_deliver",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_input.c",
            "lineNumber": 241,
            "description": "Handles locally destined packets. Reassembles IP fragments if needed."
          },
          {
            "id": "ip_local_deliver_finish",
            "name": "ip_local_deliver_finish",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_input.c",
            "lineNumber": 216,
            "description": "Invokes INPUT netfilter hook before passing to transport layer.",
            "netfilterHook": {
              "hook": "INPUT",
              "tables": [
                "mangle",
                "filter"
              ],
              "description": "Packets destined for local delivery. Firewall rules (iptables -A INPUT) evaluated here."
            }
          },
          {
            "id": "ip_protocol_deliver_rcu",
            "name": "ip_protocol_deliver_rcu",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_input.c",
            "lineNumber": 185,
            "description": "Dispatches packet to the transport protocol handler based on IP protocol field."
          },
          {
            "id": "tcp_v4_rcv",
            "name": "tcp_v4_rcv",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_ipv4.c",
            "lineNumber": 1926,
            "description": "TCP receive entry point. Validates TCP checksum and looks up socket."
          },
          {
            "id": "tcp_v4_do_rcv",
            "name": "tcp_v4_do_rcv",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_ipv4.c",
            "lineNumber": 1651,
            "description": "Main TCP receive handler. Processes TCP header and updates connection state.",
            "skbMutation": {
              "operation": "pull",
              "headerType": "tcp",
              "size": 20,
              "description": "Pull tcp header"
            }
          },
          {
            "id": "tcp_rcv_established",
            "name": "tcp_rcv_established",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_input.c",
            "lineNumber": 5685,
            "description": "Fast path for established connections. Handles ACKs, window updates, and data."
          },
          {
            "id": "tcp_data_queue",
            "name": "tcp_data_queue",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_input.c",
            "lineNumber": 4796,
            "description": "Queues received data. Handles out-of-order segments and SACK."
          },
          {
            "id": "tcp_queue_rcv",
            "name": "tcp_queue_rcv",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_input.c",
            "lineNumber": 4748,
            "description": "Adds data to socket receive queue. Updates TCP receive window."
          },
          {
            "id": "sk_data_ready",
            "name": "sk_data_ready",
            "layer": "Socket Layer",
            "sourceFile": "net/core/sock.c",
            "lineNumber": 2768,
            "description": "Wakes up any process waiting to read from the socket. Data is now available for recv().",
            "isExitPoint": true
          }
        ],
        "edges": [
          {
            "from": "napi_poll",
            "to": "napi_gro_receive",
            "order": 1
          },
          {
            "from": "napi_gro_receive",
            "to": "napi_skb_finish",
            "order": 1
          },
          {
            "from": "napi_skb_finish",
            "to": "netif_receive_skb",
            "order": 1
          },
          {
            "from": "netif_receive_skb",
            "to": "netif_receive_skb_internal",
            "order": 1
          },
          {
            "from": "netif_receive_skb_internal",
            "to": "__netif_receive_skb",
            "order": 1
          },
          {
            "from": "__netif_receive_skb",
            "to": "__netif_receive_skb_one_core",
            "order": 1
          },
          {
            "from": "__netif_receive_skb_one_core",
            "to": "__netif_receive_skb_core",
            "order": 1
          },
          {
            "from": "__netif_receive_skb_core",
            "to": "deliver_skb",
            "order": 1
          },
          {
            "from": "deliver_skb",
            "to": "ip_rcv",
            "condition": "Protocol is IPv4",
            "order": 1
          },
          {
            "from": "ip_rcv",
            "to": "ip_rcv_finish",
            "order": 1
          },
          {
            "from": "ip_rcv_finish",
            "to": "ip_local_deliver",
            "condition": "Destination is local",
            "order": 1
          },
          {
            "from": "ip_local_deliver",
            "to": "ip_local_deliver_finish",
            "order": 1
          },
          {
            "from": "ip_local_deliver_finish",
            "to": "ip_protocol_deliver_rcu",
            "order": 1
          },
          {
            "from": "ip_protocol_deliver_rcu",
            "to": "tcp_v4_rcv",
            "condition": "Protocol is TCP",
            "order": 1
          },
          {
            "from": "tcp_v4_rcv",
            "to": "tcp_v4_do_rcv",
            "condition": "Socket found",
            "order": 1
          },
          {
            "from": "tcp_v4_do_rcv",
            "to": "tcp_rcv_established",
            "condition": "Connection established",
            "order": 1
          },
          {
            "from": "tcp_rcv_established",
            "to": "tcp_data_queue",
            "condition": "Has data",
            "order": 1
          },
          {
            "from": "tcp_data_queue",
            "to": "tcp_queue_rcv",
            "order": 1
          },
          {
            "from": "tcp_queue_rcv",
            "to": "sk_data_ready",
            "order": 1
          }
        ],
        "entryPoint": "napi_poll",
        "exitPoints": [
          "sk_data_ready"
        ]
      },
      "simulation": [
        {
          "stepNumber": 1,
          "function": {
            "id": "napi_poll",
            "name": "napi_poll",
            "layer": "Device Driver",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 6513,
            "description": "NAPI polling entry point. Called by softirq to process received packets from the driver's ring buffer.",
            "isEntryPoint": true
          },
          "skbuffState": {
            "head": 0,
            "data": 0,
            "tail": 1054,
            "end": 2048,
            "layers": [
              {
                "protocol": "ethernet",
                "offset": 0,
                "size": 14
              },
              {
                "protocol": "ip",
                "offset": 14,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 34,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 2,
          "function": {
            "id": "napi_gro_receive",
            "name": "napi_gro_receive",
            "layer": "Device Driver",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 5895,
            "description": "Generic Receive Offload handler. XDP programs run here before sk_buff allocation.",
            "bpfHook": {
              "type": "XDP",
              "attachPoint": "NIC driver RX path",
              "description": "eXpress Data Path. Runs before sk_buff allocation for maximum performance. Can drop, pass, or redirect packets.",
              "actions": [
                "XDP_PASS",
                "XDP_DROP",
                "XDP_TX",
                "XDP_REDIRECT",
                "XDP_ABORTED"
              ]
            }
          },
          "skbuffState": {
            "head": 0,
            "data": 0,
            "tail": 1054,
            "end": 2048,
            "layers": [
              {
                "protocol": "ethernet",
                "offset": 0,
                "size": 14
              },
              {
                "protocol": "ip",
                "offset": 14,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 34,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 3,
          "function": {
            "id": "napi_skb_finish",
            "name": "napi_skb_finish",
            "layer": "Device Driver",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 5767,
            "description": "Finishes GRO processing and passes the sk_buff up the stack."
          },
          "skbuffState": {
            "head": 0,
            "data": 0,
            "tail": 1054,
            "end": 2048,
            "layers": [
              {
                "protocol": "ethernet",
                "offset": 0,
                "size": 14
              },
              {
                "protocol": "ip",
                "offset": 14,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 34,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 4,
          "function": {
            "id": "netif_receive_skb",
            "name": "netif_receive_skb",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 5362,
            "description": "Main entry point for receiving packets from the driver. Timestamps and prepares the packet."
          },
          "skbuffState": {
            "head": 0,
            "data": 0,
            "tail": 1054,
            "end": 2048,
            "layers": [
              {
                "protocol": "ethernet",
                "offset": 0,
                "size": 14
              },
              {
                "protocol": "ip",
                "offset": 14,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 34,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 5,
          "function": {
            "id": "netif_receive_skb_internal",
            "name": "netif_receive_skb_internal",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 5320,
            "description": "Internal receive handler. Handles RPS (Receive Packet Steering) if enabled."
          },
          "skbuffState": {
            "head": 0,
            "data": 0,
            "tail": 1054,
            "end": 2048,
            "layers": [
              {
                "protocol": "ethernet",
                "offset": 0,
                "size": 14
              },
              {
                "protocol": "ip",
                "offset": 14,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 34,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 6,
          "function": {
            "id": "__netif_receive_skb",
            "name": "__netif_receive_skb",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 5247,
            "description": "Core receive function. TC ingress BPF programs and generic XDP run here.",
            "bpfHook": {
              "type": "TC_INGRESS",
              "attachPoint": "Traffic Control ingress qdisc",
              "description": "Traffic Control classifier. Can filter, modify, or redirect packets on ingress.",
              "actions": [
                "TC_ACT_OK",
                "TC_ACT_SHOT",
                "TC_ACT_REDIRECT",
                "TC_ACT_PIPE"
              ]
            }
          },
          "skbuffState": {
            "head": 0,
            "data": 0,
            "tail": 1054,
            "end": 2048,
            "layers": [
              {
                "protocol": "ethernet",
                "offset": 0,
                "size": 14
              },
              {
                "protocol": "ip",
                "offset": 14,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 34,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 7,
          "function": {
            "id": "__netif_receive_skb_one_core",
            "name": "__netif_receive_skb_one_core",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 5198,
            "description": "Single-core receive path. Processes packet on current CPU."
          },
          "skbuffState": {
            "head": 0,
            "data": 0,
            "tail": 1054,
            "end": 2048,
            "layers": [
              {
                "protocol": "ethernet",
                "offset": 0,
                "size": 14
              },
              {
                "protocol": "ip",
                "offset": 14,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 34,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 8,
          "function": {
            "id": "__netif_receive_skb_core",
            "name": "__netif_receive_skb_core",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 5067,
            "description": "Core packet classification. Strips Ethernet header and determines protocol handler.",
            "skbMutation": {
              "operation": "pull",
              "headerType": "ethernet",
              "size": 14,
              "description": "Pull ethernet header"
            }
          },
          "skbuffState": {
            "head": 0,
            "data": 14,
            "tail": 1054,
            "end": 2048,
            "layers": [
              {
                "protocol": "ip",
                "offset": 0,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 20,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 9,
          "function": {
            "id": "deliver_skb",
            "name": "deliver_skb",
            "layer": "Data Link Layer",
            "sourceFile": "net/core/dev.c",
            "lineNumber": 1988,
            "description": "Delivers packet to the registered protocol handler (e.g., ip_rcv for IPv4)."
          },
          "skbuffState": {
            "head": 0,
            "data": 14,
            "tail": 1054,
            "end": 2048,
            "layers": [
              {
                "protocol": "ip",
                "offset": 0,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 20,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 10,
          "function": {
            "id": "ip_rcv",
            "name": "ip_rcv",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_input.c",
            "lineNumber": 523,
            "description": "IPv4 receive entry point. Validates IP header checksum and invokes PREROUTING netfilter hook.",
            "netfilterHook": {
              "hook": "PREROUTING",
              "tables": [
                "raw",
                "mangle",
                "nat"
              ],
              "description": "First hook for incoming packets. DNAT applied here before routing.",
              "priority": -300
            }
          },
          "skbuffState": {
            "head": 0,
            "data": 14,
            "tail": 1054,
            "end": 2048,
            "layers": [
              {
                "protocol": "ip",
                "offset": 0,
                "size": 20
              },
              {
                "protocol": "tcp",
                "offset": 20,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 11,
          "function": {
            "id": "ip_rcv_finish",
            "name": "ip_rcv_finish",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_input.c",
            "lineNumber": 401,
            "description": "Finishes IP header processing. Performs routing lookup and strips IP header.",
            "skbMutation": {
              "operation": "pull",
              "headerType": "ip",
              "size": 20,
              "description": "Pull ip header"
            }
          },
          "skbuffState": {
            "head": 0,
            "data": 34,
            "tail": 1054,
            "end": 2048,
            "layers": [
              {
                "protocol": "tcp",
                "offset": 0,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 12,
          "function": {
            "id": "ip_local_deliver",
            "name": "ip_local_deliver",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_input.c",
            "lineNumber": 241,
            "description": "Handles locally destined packets. Reassembles IP fragments if needed."
          },
          "skbuffState": {
            "head": 0,
            "data": 34,
            "tail": 1054,
            "end": 2048,
            "layers": [
              {
                "protocol": "tcp",
                "offset": 0,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 13,
          "function": {
            "id": "ip_local_deliver_finish",
            "name": "ip_local_deliver_finish",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_input.c",
            "lineNumber": 216,
            "description": "Invokes INPUT netfilter hook before passing to transport layer.",
            "netfilterHook": {
              "hook": "INPUT",
              "tables": [
                "mangle",
                "filter"
              ],
              "description": "Packets destined for local delivery. Firewall rules (iptables -A INPUT) evaluated here."
            }
          },
          "skbuffState": {
            "head": 0,
            "data": 34,
            "tail": 1054,
            "end": 2048,
            "layers": [
              {
                "protocol": "tcp",
                "offset": 0,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 14,
          "function": {
            "id": "ip_protocol_deliver_rcu",
            "name": "ip_protocol_deliver_rcu",
            "layer": "Network Layer",
            "sourceFile": "net/ipv4/ip_input.c",
            "lineNumber": 185,
            "description": "Dispatches packet to the transport protocol handler based on IP protocol field."
          },
          "skbuffState": {
            "head": 0,
            "data": 34,
            "tail": 1054,
            "end": 2048,
            "layers": [
              {
                "protocol": "tcp",
                "offset": 0,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 15,
          "function": {
            "id": "tcp_v4_rcv",
            "name": "tcp_v4_rcv",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_ipv4.c",
            "lineNumber": 1926,
            "description": "TCP receive entry point. Validates TCP checksum and looks up socket."
          },
          "skbuffState": {
            "head": 0,
            "data": 34,
            "tail": 1054,
            "end": 2048,
            "layers": [
              {
                "protocol": "tcp",
                "offset": 0,
                "size": 20
              }
            ]
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 16,
          "function": {
            "id": "tcp_v4_do_rcv",
            "name": "tcp_v4_do_rcv",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_ipv4.c",
            "lineNumber": 1651,
            "description": "Main TCP receive handler. Processes TCP header and updates connection state.",
            "skbMutation": {
              "operation": "pull",
              "headerType": "tcp",
              "size": 20,
              "description": "Pull tcp header"
            }
          },
          "skbuffState": {
            "head": 0,
            "data": 54,
            "tail": 1054,
            "end": 2048,
            "layers": []
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 17,
          "function": {
            "id": "tcp_rcv_established",
            "name": "tcp_rcv_established",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_input.c",
            "lineNumber": 5685,
            "description": "Fast path for established connections. Handles ACKs, window updates, and data."
          },
          "skbuffState": {
            "head": 0,
            "data": 54,
            "tail": 1054,
            "end": 2048,
            "layers": []
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 18,
          "function": {
            "id": "tcp_data_queue",
            "name": "tcp_data_queue",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_input.c",
            "lineNumber": 4796,
            "description": "Queues received data. Handles out-of-order segments and SACK."
          },
          "skbuffState": {
            "head": 0,
            "data": 54,
            "tail": 1054,
            "end": 2048,
            "layers": []
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 19,
          "function": {
            "id": "tcp_queue_rcv",
            "name": "tcp_queue_rcv",
            "layer": "Transport Layer",
            "sourceFile": "net/ipv4/tcp_input.c",
            "lineNumber": 4748,
            "description": "Adds data to socket receive queue. Updates TCP receive window."
          },
          "skbuffState": {
            "head": 0,
            "data": 54,
            "tail": 1054,
            "end": 2048,
            "layers": []
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        },
        {
          "stepNumber": 20,
          "function": {
            "id": "sk_data_ready",
            "name": "sk_data_ready",
            "layer": "Socket Layer",
            "sourceFile": "net/core/sock.c",
            "lineNumber": 2768,
            "description": "Wakes up any process waiting to read from the socket. Data is now available for recv().",
            "isExitPoint": true
          },
          "skbuffState": {
            "head": 0,
            "data": 54,
            "tail": 1054,
            "end": 2048,
            "layers": []
          },
          "conntrackState": {
            "state": "ESTABLISHED",
            "description": "Connection established. Bidirectional traffic allowed."
          }
        }
      ]
    }
  ],
  "metadata": {
    "layers": [
      {
        "id": "user",
        "name": "User Space",
        "cssClass": "layer-user",
        "order": 0
      },
      {
        "id": "socket",
        "name": "Socket Layer",
        "cssClass": "layer-socket",
        "order": 1
      },
      {
        "id": "transport",
        "name": "Transport Layer",
        "cssClass": "layer-transport",
        "order": 2
      },
      {
        "id": "network",
        "name": "Network Layer",
        "cssClass": "layer-network",
        "order": 3
      },
      {
        "id": "datalink",
        "name": "Data Link Layer",
        "cssClass": "layer-datalink",
        "order": 4
      },
      {
        "id": "driver",
        "name": "Device Driver",
        "cssClass": "layer-driver",
        "order": 5
      }
    ],
    "headerSizes": {
      "ethernet": 14,
      "icmp": 8,
      "ip": 20,
      "ipv6": 40,
      "tcp": 20,
      "udp": 8
    },
    "bufferSize": 2048,
    "payloadSize": 1000
  }
}